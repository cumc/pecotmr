% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ctwas_wrapper.R
\name{twas_top_signals}
\alias{twas_top_signals}
\title{cTWAS (causal-TWAS) wrapper
Determine Imputability and Variant Selection

Assesses the imputability of genes across different contexts and selects a subset of SNPs with high Posterior Inclusion Probabilities (PIPs) from SuSiE fine-mapping results. It retrieves variant weights and identifies the best-performing methods based on cross-validation metrics. This function is essential for preparing data for complex trait weighted analysis.}
\usage{
twas_top_signals(
  weight_db_file,
  contexts = NULL,
  variable_name_obj = c("preset_variants_result", "variant_names"),
  susie_obj = c("preset_variants_result", "susie_result_trimmed"),
  twas_weights_table = "twas_weights",
  max_var_selection,
  min_rsq_threshold = 0.01,
  p_val_cutoff = 0.05
)
}
\arguments{
\item{variable_name_obj}{Name of the element in SuSiE-TWAS output that lists variant names aligned with TWAS weights.}

\item{max_var_selection}{Maximum number of SNPs to be selected from each gene-context pair.}

\item{min_rsq_threshold}{Minimum \(R^2\) threshold for determining imputability of a gene-context pair.}

\item{p_val_cutoff}{Maximum allowable p-value for a gene to be considered imputable in a given context.}

\item{weight_db_files}{File paths to `.rds` files containing SuSiE-TWAS weights.}
}
\value{
A list of elements containing fine-mapping and TWAS related data:
\itemize{
  \item{susie_results}{SuSiE fine-mapping results, including variant selection from the SuSiE-TWAS pipeline.}
  \item{model_selection}{Identification of the best-performing TWAS method for each context, based on cross-validation.}
  \item{weights}{TWAS weights from the SuSiE-TWAS pipeline, to be harmonized for further analysis.}
  \item{region_info}{Region information corresponding to each gene, critical for interpreting SuSiE-TWAS weight inputs.}
}
}
\description{
Causal inference for TWAS with Summary Statistics with Multigroup Data
}
\examples{
results <- determine_imputability(weight_db_file = "path/to/weights.rds", conditions=c("Mic", "Oli", "Exc"),
                                  max_var_selection = 10, min_rsq_threshold = 0.01, p_val_cutoff = 0.05)
}
