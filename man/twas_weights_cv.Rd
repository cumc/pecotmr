% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/twas.R
\name{twas_weights_cv}
\alias{twas_weights_cv}
\title{Cross-Validation for Transcriptome-Wide Association Studies (TWAS)}
\usage{
twas_weights_cv(
  X,
  Y,
  fold = NULL,
  sample_partitions = NULL,
  methods = NULL,
  seed = NULL,
  num_threads = 1
)
}
\arguments{
\item{X}{A matrix of samples by features, where each row represents a sample and each column a feature.}

\item{Y}{A matrix (or vector, which will be converted to a matrix) of samples by outcomes, where each row corresponds to a sample.}

\item{fold}{An optional integer specifying the number of folds for cross-validation. 
If NULL, 'sample_partitions' must be provided.}

\item{sample_partitions}{An optional dataframe with predefined sample partitions, 
containing columns 'Sample' (sample names) and 'Fold' (fold number). If NULL, 'fold' must be provided.}

\item{methods}{A list of methods and their specific arguments, formatted as list(method1 = method1_args, method2 = method2_args). 
Methods in the list can be either univariate (applied to each column of Y) or multivariate (applied to the entire Y matrix).}

\item{seed}{An optional integer to set the random seed for reproducibility of sample splitting.}

\item{num_threads}{The number of threads to use for parallel processing.
If set to -1, the function uses all available cores.
If set to 0 or 1, no parallel processing is performed.
If set to 2 or more, parallel processing is enabled with that many threads.}
}
\value{
A list with the following components:
\itemize{
  \item `sample_partition`: A dataframe showing the sample partitioning used in the cross-validation.
  \item `results`: A list of results for each method. Each list element contains:
    \itemize{
      \item `predictions`: A matrix of predicted Y values for each fold.
      \item `rsq_pval`: A matrix with rows representing methods and two columns for R-squared and p-value, calculated for each column of Y.
    }
}
}
\description{
Performs cross-validation for TWAS, supporting both univariate and multivariate methods. 
It can either create folds for cross-validation or use pre-defined sample partitions. 
For multivariate methods, it applies the method to the entire Y matrix for each fold.
}
